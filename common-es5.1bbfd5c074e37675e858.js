function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,r=!1,o=void 0;try{for(var c,a=e[Symbol.iterator]();!(i=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);i=!0);}catch(s){r=!0,o=s}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"4T9E":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return u}));var i=function(e){return e.EditMode="[Document] edit mode",e.ViewMode="[Document] view mode",e.ShowPreview="[Document] show preview",e.Refresh="[Document] Refresh",e.HidePreview="[Document] hide preview",e.EditIt="[Document] edit it",e}({}),r=function e(){_classCallCheck(this,e),this.type=i.EditMode},o=function e(){_classCallCheck(this,e),this.type=i.ViewMode},c=function e(){_classCallCheck(this,e),this.type=i.ShowPreview},a=function e(){_classCallCheck(this,e),this.type=i.HidePreview},s=function e(){_classCallCheck(this,e),this.type=i.Refresh},u=function e(t){_classCallCheck(this,e),this.payload=t,this.type=i.EditIt}},"71SZ":function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i=n("q/PB"),r=n("sGad"),o=n("kt0X"),c=n("XNiG"),a=n("VRyK"),s=n("D0XW"),u=n("btWG"),l=n("was7"),d=n("1G5W"),f=n("lJxs"),h=n("pxpQ"),p=n("eIep"),w=n("uYpP"),b=n("fXoL"),v=n("dNgK"),m=n("ofXK"),g=["viewContainerDiv"];function y(e,t){if(1&e&&b.Ob(0,"ms-reading-position-indicator",7),2&e){b.ec();var n=b.pc(8);b.jc("element",n)}}var k=function(e){return{container$:e}},O=function(e){return[e]},C=function(){var e=function(){function e(t,n,p,w,b,v){var m=this;_classCallCheck(this,e),this.store=t,this.snackBar=n,this.markdownService=p,this.ngZone=w,this._docRef=b,this._location=v,this.destroy$=new c.a,this.DocumentMode=l.a,this.docMode$=this.store.pipe(Object(o.k)(r.h)),this.editWithView$=this.store.pipe(Object(o.k)(r.i)),this.defaultTimeoutHandler=function(e){return m.snackBar.open(e.message,"ok",{duration:i.p})},this.isScrollDown$=this.store.select(r.k).pipe(Object(d.a)(this.destroy$)).subscribe((function(e){var t=e.isScrollDown;null!==t&&m.viewerContainerDiv&&(t?m.viewerContainerDiv.nativeElement.scrollTop+=50:m.viewerContainerDiv.nativeElement.scrollTop-=50)})),this.isLoadDone$=Object(a.a)(Object(u.monitorActionStatus$)(this.store,u.DocumentEffectsActionType.ReadDocument,i.r,this.defaultTimeoutHandler).pipe(Object(f.a)((function(e){return e.isNotStartStatus()}))),Object(u.actionStatusState$)(this.store,u.DocumentEffectsActionType.Create).pipe(Object(f.a)((function(e){return e.isNotStartStatus()})))).pipe(Object(d.a)(this.destroy$),Object(h.b)(s.b))}return _createClass(e,[{key:"ngAfterViewInit",value:function(){var e=this,t=this;this.container=new i.e(this.viewerContainerDiv.nativeElement,void 0,void 0,this.ngZone),this.viewerContainerDiv.nativeElement.focus(),this.scrollDown$=this.container.scrollDown$,this.markdownService.viewer$.next(this.container),setTimeout((function(t){return e.scroll()}),500);var n=0;this.isLockScrollWithView$=this.store.pipe(Object(o.k)(r.j)),this.isLockScrollWithView$.pipe(Object(d.a)(this.destroy$)).subscribe((function(t){e.isLockScrollWithView=t})),this.markdownService.editor$.pipe(Object(d.a)(this.destroy$),Object(p.a)((function(e){return e.scrollDown$}))).subscribe((function(i){if(e.isLockScrollWithView&&i.event){var r=i.event.target,o=r.scrollTop/(r.scrollHeight-r.clientHeight),c=o-n;n=o;var a=t.viewerContainerDiv.nativeElement;t.viewerContainerDiv.nativeElement.scrollTop+=(a.scrollHeight-a.clientHeight)*c}})),this.viewerContainerDiv.nativeElement.addEventListener("edit-it",(function(t){e.store.dispatch(new r.a(t.detail))}))}},{key:"scroll",value:function(){var e=this.getCurrentHash();if(e){var t=this._docRef.document.getElementById(e);if(!t)return;t.scrollIntoView(),this.viewerContainerDiv.nativeElement.scrollTop=t.offsetTop-64}}},{key:"getCurrentHash",value:function(){return decodeURIComponent(this._location.hash.replace(/^#/,""))}},{key:"ngOnDestroy",value:function(){this.destroy$.next()}},{key:"swipe",value:function(e){var t=e.target,n="",i=0;do{n=t.getAttribute("data-source-lines"),t=t.parentElement}while(!n&&t&&i++<4);this.store.dispatch(new r.a({sourceLine:JSON.parse(n)}))}},{key:"swipeLeft",value:function(e){this.swipe(e)}},{key:"swipeRight",value:function(e){this.swipe(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(b.Nb(o.c),b.Nb(v.c),b.Nb(w.a),b.Nb(b.z),b.Nb(i.n),b.Nb(m.D))},e.\u0275cmp=b.Hb({type:e,selectors:[["markdown-viewer-container"]],viewQuery:function(e,t){var n;1&e&&b.Ec(g,!0),2&e&&b.oc(n=b.bc())&&(t.viewerContainerDiv=n.first)},inputs:{markdown$:"markdown$",hideToolbar:"hideToolbar"},decls:11,vars:17,consts:[[3,"scrollHide","hide"],[3,"element",4,"ngIf"],[3,"isRunning"],[2,"position","relative","height","100%"],[1,"viewer-container"],["viewContainerDiv",""],[1,"markdown-viewer",3,"model","swipeleft","swiperight"],[3,"element"]],template:function(e,t){if(1&e&&(b.Ob(0,"ms-viewer-toolbar",0),b.fc(1,"async"),b.zc(2,y,1,1,"ms-reading-position-indicator",1),b.fc(3,"async"),b.Ob(4,"sk-three-bounce",2),b.fc(5,"async"),b.Tb(6,"div",3),b.Tb(7,"div",4,5),b.Tb(9,"markdown-viewer",6),b.ac("swipeleft",(function(e){return t.swipeLeft(e)}))("swiperight",(function(e){return t.swipeRight(e)})),b.fc(10,"async"),b.Sb(),b.Sb(),b.Sb()),2&e){var n,i=null==(n=b.gc(3,7,t.scrollDown$))?null:n.isDown;b.jc("scrollHide",b.mc(15,O,b.mc(13,k,t.markdownService.viewer$)))("hide",b.gc(1,5,t.docMode$)!==t.DocumentMode.View),b.Ab(2),b.jc("ngIf",i),b.Ab(2),b.jc("isRunning",!b.gc(5,9,t.isLoadDone$)),b.Ab(5),b.jc("model",b.gc(10,11,t.markdown$))}},styles:[".viewer-container[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:auto;padding:0 3px;height:100%}@media (min-width:960px){.viewer-container[_ngcontent-%COMP%]{padding:0 16px}}.markdown-viewer[_ngcontent-%COMP%]{max-width:1000px;margin:auto}.markdown-viewer[_ngcontent-%COMP%]:focus{outline:none}"]}),e}()},Kq4L:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));var i=function(e){return e.Save="[Edit] Save",e.LockScrollWithView="[Edit] Lock Scroll With View",e.EditorLoaded="[Edit] Editor Loaded",e.EditorUnloaded="[Edit] Editor Unloaded",e}({}),r=function e(t){_classCallCheck(this,e),this.payload=t,this.type=i.Save},o=function e(t){_classCallCheck(this,e),this.payload=t,this.type=i.LockScrollWithView}},fFD9:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("DH7j"),r=n("itXk"),o=n("Cfvw");function c(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var c=null;return"function"==typeof t[t.length-1]&&(c=t.pop()),1===t.length&&Object(i.a)(t[0])&&(t=t[0].slice()),function(e){return e.lift.call(Object(o.a)([e].concat(_toConsumableArray(t))),new r.a(c))}}},nJwD:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var i=n("4T9E"),r=n("ofXK"),o=n("1G5W"),c=n("lJxs"),a=n("fFD9"),s=n("pLZG"),u=n("vkgz"),l=n("q/PB"),d=n("kt0X"),f=n("sGad"),h=n("was7"),p=n("71SZ"),w=n("XNiG"),b=n("VRyK"),v=n("btWG"),m=n("uYpP"),g=n("fXoL"),y=n("tk/3"),k=n("tyNb"),O=n("ZYfY"),C=n("103i"),j=["viewerDiv"],_=["editorDiv"],S=function(){var e=function(){function e(t,n,r,s,u,l,p,v){var m=this;_classCallCheck(this,e),this.markdownService=t,this._http=n,this.baseHref=r,this.changeDetecorRef=s,this.route=u,this.router=l,this.store=p,this.utils=v,this.fixEditButton=!1,this.destroy$=new w.a,this.docMode$=this.store.pipe(Object(d.k)(f.h),Object(o.a)(this.destroy$)),this.showEdit$=this.docMode$.pipe(Object(c.a)((function(e){return e===h.a.Edit}))),this.isScreenWide$=this.utils.isScreenWide$,this.showView$=Object(b.a)(this.showEdit$.pipe(Object(a.a)(this.isScreenWide$),Object(c.a)((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return n&&!r?(m.store.dispatch(new i.d),!1):(m.store.dispatch(new i.f),!0)}))),this.store.select(f.i))}return _createClass(e,[{key:"ngOnInit",value:function(){this.router.routerState.root.firstChild.queryParams.subscribe((function(e){console.log(e)})),this.markdown$=Object(b.a)(this.store.select(v.selectCurrentDocumentState).pipe(Object(s.a)((function(e){return e&&!e.isUpdateMeta})),Object(c.a)((function(e){return e&&e.content?e.content.content:""}))),this.markdownService.editorContentChanged$).pipe(Object(l.z)(80,1e3))}},{key:"ngOnDestroy",value:function(){this.store.dispatch(new v.SetCurrentDocumentId({id:void 0})),this.destroy$.next()}},{key:"ngAfterViewChecked",value:function(){this.changeDetecorRef.detectChanges()}},{key:"ngAfterViewInit",value:function(){var e=this;this.router.routerState.root.firstChild.queryParams.pipe(Object(u.a)((function(t){e.router.url.startsWith("/doc/new")?(e.store.dispatch(new v.DocumentEffectsCreate({format:t.f})),e.store.dispatch(new i.c)):e.store.dispatch(new v.DocumentEffectsRead({id:+t.id,title:t.title,format:t.f}))}))).subscribe()}},{key:"showDemo",value:function(){this._http.get(this.baseHref+"assets/markdown.md",{responseType:"text"}).subscribe((function(){}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Nb(m.a),g.Nb(y.b),g.Nb(r.a),g.Nb(g.h),g.Nb(k.a),g.Nb(k.f),g.Nb(d.c),g.Nb(O.a))},e.\u0275cmp=g.Hb({type:e,selectors:[["ms-markdown"]],viewQuery:function(e,t){var n;1&e&&(g.Ec(p.a,!0),g.Ec(j,!0),g.Ec(_,!0)),2&e&&(g.oc(n=g.bc())&&(t.viewer=n.first),g.oc(n=g.bc())&&(t.viewerDiv=n.first),g.oc(n=g.bc())&&(t.editorDiv=n.first))},decls:10,vars:9,consts:[[1,"markdown-container"],["primary-component-minsize","100","secondary-component-minsize","100","local-storage-key","iam-md-split-pane","primary-component-initialratio","0.5",3,"primary-component-toggled-off","secondary-component-toggled-off"],[1,"split-pane-content-primary"],["editorDiv",""],[1,"split-pane-content-secondary"],["viewerDiv",""],[3,"markdown$"]],template:function(e,t){1&e&&(g.Tb(0,"div",0),g.Tb(1,"vertical-split-pane",1),g.fc(2,"async"),g.fc(3,"async"),g.Tb(4,"div",2,3),g.Ob(6,"router-outlet"),g.Sb(),g.Tb(7,"div",4,5),g.Ob(9,"markdown-viewer-container",6),g.Sb(),g.Sb(),g.Sb()),2&e&&(g.Eb("fullscreen",t.isFullScreen),g.Ab(1),g.jc("primary-component-toggled-off",!g.gc(2,5,t.showEdit$))("secondary-component-toggled-off",!g.gc(3,7,t.showView$)),g.Ab(8),g.jc("markdown$",t.markdown$))},directives:[C.a,k.k,p.a],pipes:[r.b],styles:['.markdown-container[_ngcontent-%COMP%]   .md-footer[_ngcontent-%COMP%]{padding:2px;background-color:#f0f0f0;border-top:1px solid rgba(0,0,0,.1)}.markdown-container.fullscreen[_ngcontent-%COMP%]{margin:0;position:fixed;border:0;top:0;left:0;width:100%;height:100%;z-index:99999999}.split-pane-content-secondary[_ngcontent-%COMP%]{height:100%}.markdown-container.fullscreen[_ngcontent-%COMP%]   .md-editor-panel[_ngcontent-%COMP%], .markdown-container.fullscreen[_ngcontent-%COMP%]   .md-view-panel[_ngcontent-%COMP%]{height:calc(100vh - 40px)!important}.markdown-container[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:first-child:before{content:" ";background-color:#a9a9a9;width:1px;height:24px;left:-9px;top:2px;position:absolute}.markdown-container[_ngcontent-%COMP%]{height:100vh;overflow:hidden}.markdown-container[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%]   .btn-group.hide-split[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:first-child:before{display:none}.markdown-container[_ngcontent-%COMP%]   .tool-bar[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:0}.markdown-container[_ngcontent-%COMP%]   .editor-container[_ngcontent-%COMP%]{display:flex}.markdown-container[_ngcontent-%COMP%]   .editor-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1 1 0;width:0;min-height:200px}']}),e}()},sGad:function(e,t,n){"use strict";n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return w})),n.d(t,"g",(function(){return b})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return g})),n.d(t,"b",(function(){return y.c})),n.d(t,"c",(function(){return y.g})),n.d(t,"a",(function(){return y.b})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return d}));var i=n("kt0X"),r=function(e){return e.Scroll="[View] Scroll",e}({}),o=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.Scroll},c={isScrollDown:null},a=n("was7"),s=n("Kq4L"),u={save:"",lockScrollWithView:!1,editor:void 0,content:void 0},l="markdown",d={document:a.e,edit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s.a.Save:return Object.assign(Object.assign({},e),{save:t.payload});case s.a.LockScrollWithView:return Object.assign(Object.assign({},e),{lockScrollWithView:t.payload});default:return e}},view:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.Scroll:return Object.assign(Object.assign({},e),{isScrollDown:t.payload.isScrollDown});default:return e}}},f=Object(i.i)(l),h=Object(i.j)(f,(function(e){return e.document})),p=Object(i.j)(h,a.c),w=Object(i.j)(h,a.d),b=Object(i.j)(h,a.b),v=Object(i.j)(f,(function(e){return e.edit})),m=(Object(i.j)(v,(function(e){return e.save})),Object(i.j)(v,(function(e){return e.lockScrollWithView}))),g=Object(i.j)(f,(function(e){return e.view}));Object(i.j)(g,(function(e){return e.isScrollDown}));var y=n("4T9E")},uYpP:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=new(n("fXoL").q)("MARKDOWN_SERVICE_TOKEN")},was7:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return u}));var i=n("4T9E"),r=function(e){return e[e.View=0]="View",e[e.Edit=1]="Edit",e}({}),o={mode:r.View,showPreview:null};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.a.EditMode:return document.iamMarkdownIsPureViewMode=!1,Object.assign(Object.assign({},e),{mode:r.Edit});case i.a.ViewMode:return document.iamMarkdownIsPureViewMode=!0,Object.assign(Object.assign({},e),{mode:r.View});case i.a.ShowPreview:return Object.assign(Object.assign({},e),{showPreview:!0});case i.a.HidePreview:return Object.assign(Object.assign({},e),{showPreview:!1});case i.a.EditIt:return Object.assign(Object.assign({},e),{editIt:t.payload});default:return e}}var a=function(e){return e.mode},s=function(e){return e.showPreview},u=function(e){return e.editIt}}}]);