"use strict";(self.webpackChunkiam=self.webpackChunkiam||[]).push([["src_app_modules_markdown_viewer_elements_sub-page_subpage_module_ts"],{1261:(z,u,o)=>{o.r(u),o.d(u,{SubPageModule:()=>F});var p=o(6903),g=o(2),b=o(6681),P=o(3550),C=o(2518),v=o(6145),Z=o(6251),t=o(8079),m=o(1935),S=o(1180);let T=(()=>{class a{constructor(e){this.dialog=e}onClick(e){this.dialog.close(e)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(m.so))},a.\u0275cmp=t.Xpm({type:a,selectors:[["subpage-id-search"]],decls:1,vars:0,consts:[[3,"onClick"]],template:function(e,n){1&e&&(t.TgZ(0,"doc-search-list",0),t.NdJ("onClick",function(i){return n.onClick(i)}),t.qZA())},directives:[S.I],encapsulation:2}),a})();var y=o(4060),x=o(3863),A=o(8513),O=o(7826),c=o(5682),M=o(6134),k=o(3860),I=o(7733),E=o(7394);function J(a,r){if(1&a){const e=t.EpF();t.TgZ(0,"div",11),t.TgZ(1,"div",12),t.NdJ("click",function(){const i=t.CHM(e).$implicit;return t.oxw().onShowDoc(i)}),t.TgZ(2,"section"),t._uU(3),t.qZA(),t.TgZ(4,"span",13),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.qZA(),t.TgZ(8,"p",14),t.TgZ(9,"button",15),t.NdJ("click",function(){const i=t.CHM(e).$implicit;return t.oxw().delete(i)}),t.TgZ(10,"mat-icon"),t._uU(11,"delete_forever"),t.qZA(),t.qZA(),t.TgZ(12,"span",16),t._uU(13),t.qZA(),t.TgZ(14,"span",17),t._uU(15),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=r.$implicit;t.xp6(3),t.Oqu(e.title),t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(e.summary),t.xp6(6),t.hij(" v",e.version," "),t.xp6(2),t.AsE("",null==e.createDate?null:e.createDate.toLocaleDateString()," - ",e.updateDate.toLocaleDateString(),"")}}let _=(()=>{class a extends((0,g.P2)(v.z)){constructor(e,n,d,i,s,D){super(n,i),this.router=e,this.store=n,this.documentEffects=d,this.dialog=s,this.snackbar=D,this.isPanelOpen=!1,this.subPagesChanged=!1,this.onPanelOpen=(()=>{let h;return()=>{if(this.isPanelOpen=!0,!this.subPagesChanged)return;this.subPagesChanged=!1,this.removeSub(h),h=this.addObs(this.store.docMetasOfIds$(this.ids).pipe((0,b.U)(l=>l.filter(Y=>!!Y)),(0,P.b)(300),(0,C.b)(l=>this.pageList=l)));const{ids:f}=this;f.length>0&&this.documentEffects.readDocMetas_.next({ids:f})}})(),this.ids=[],this.pageList=[]}set pages(e){this.ids=JSON.parse(e),this.subPagesChanged=!0,this.isPanelOpen&&this.onPanelOpen()}delete(e){const n=this.ids.indexOf(e.id);if(-1!==n)return this.ids.splice(n,1),this.subPagesChanged=!0,this.source=`subPage: [${this.ids}]`,void(this.isPanelOpen&&this.onPanelOpen());this.logger.debug("SubPageComponent.delete: id not found")}addId(e,n){this.ids.includes(+e)?this.snackbar.open(`id ${e} already included`,"ok",{duration:g.yJ}):(this.ids.push(+e),this.subPagesChanged=!0,this.source=`subPage: [${this.ids}]`,n&&(n.value=null))}addIdBySearch(){this.dialog.open(T).afterClosed().subscribe(n=>this.addId(n.id))}onShowDoc(e){this.router.navigate(["/doc"],{queryParams:{id:e.id,title:e.title,f:e.format||"md"}})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(y.F0),t.Y36(x.G),t.Y36(Z.CL),t.Y36(A.d),t.Y36(m.uw),t.Y36(O.ux))},a.\u0275cmp=t.Xpm({type:a,selectors:[["i-subpage"]],inputs:{pages:"pages"},features:[t.qOj],decls:16,vars:2,consts:[[2,"background-color","transparent","box-shadow","none",3,"opened","closed"],[1,"action-group",3,"click"],[1,"id-input-group"],["placeholder","add by id","matInput","","type","number",1,"id-input",3,"keydown.Enter","keyup.Enter"],["input",""],["matSuffix","","mat-icon-button","","aria-label","add id",3,"click"],[2,"color","#000a"],["mat-button",""],[2,"color","#000a",3,"click"],[1,"card-container"],["class","docs-card",4,"ngFor","ngForOf"],[1,"docs-card"],[1,"card-body",3,"click"],[1,"doc-id"],[1,"meta-version-date","card-footer"],["mat-button","",1,"delete-button",3,"click"],[1,"meta-version"],[1,"meta-date",2,"margin-left","10px"]],template:function(e,n){if(1&e){const d=t.EpF();t.TgZ(0,"mat-expansion-panel",0),t.NdJ("opened",function(){return n.onPanelOpen()})("closed",function(){return n.isPanelOpen=!1}),t.TgZ(1,"mat-expansion-panel-header"),t.TgZ(2,"mat-panel-title"),t._uU(3),t.qZA(),t.TgZ(4,"div",1),t.NdJ("click",function(s){return s.stopImmediatePropagation()}),t.TgZ(5,"div",2),t.TgZ(6,"input",3,4),t.NdJ("keydown.Enter",function(s){return s.stopPropagation()})("keyup.Enter",function(){t.CHM(d);const s=t.MAs(7);return n.addId(s.value,s)}),t.qZA(),t.TgZ(8,"button",5),t.NdJ("click",function(){t.CHM(d);const s=t.MAs(7);return n.addId(s.value,s)}),t.TgZ(9,"mat-icon",6),t._uU(10,"add"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"button",7),t.TgZ(12,"mat-icon",8),t.NdJ("click",function(){return n.addIdBySearch()}),t._uU(13,"zoom_in"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",9),t.YNc(15,J,16,6,"div",10),t.qZA(),t.qZA()}2&e&&(t.xp6(3),t.hij(" Subpages(",n.ids.length,") "),t.xp6(12),t.Q6J("ngForOf",n.pageList))},directives:[c.ib,c.yz,c.yK,M.Nt,k.lW,I.R9,E.Hw,p.sg],styles:[".doc-id[_ngcontent-%COMP%]{position:absolute;right:1.2rem;font-size:small;top:1rem;color:gray}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.id-input-group[_ngcontent-%COMP%]{display:flex;border:lightgray solid .1rem;padding-left:1rem;font-size:medium;height:3rem;align-items:center}.action-group[_ngcontent-%COMP%]{display:flex;align-items:center;grid-column-gap:1rem;column-gap:1rem;margin-right:1rem}.id-input[_ngcontent-%COMP%]{width:6.5rem;margin-top:.02rem}"]}),a})();var N=o(1677),U=o(3245);let F=(()=>{class a{constructor(){this.customElementComponent=_}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[p.ez,U.B,N.t]]}),a})()}}]);