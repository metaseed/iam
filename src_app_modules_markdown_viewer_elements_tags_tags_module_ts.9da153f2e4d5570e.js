"use strict";(self.webpackChunkiam=self.webpackChunkiam||[]).push([["src_app_modules_markdown_viewer_elements_tags_tags_module_ts"],{154:(E,u,s)=>{s.r(u),s.d(u,{TagsModule:()=>D});var h=s(6903),f=s(3885),y=s(6145),m=s(2318),I=s(2950),O=s(3550),T=s(2518),c=s(2265),p=s(2118),t=s(8079),b=s(3863),L=s(8513),M=s(7826),A=s(5068),C=s(7733),g=s(37),v=s(3784),F=s(7394),P=s(3302);const R=["tagInput"],Z=["autoCompleteTrigger"];function x(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-chip",9),t.NdJ("removed",function(){const i=t.CHM(e).$implicit;return t.oxw().remove(i)}),t._uU(1),t.TgZ(2,"button",10),t.TgZ(3,"mat-icon"),t._uU(4,"cancel"),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=r.$implicit,o=t.oxw();let a;t.Udp("color","#"+e.color)("background-color","#"+e.color+"22")("border","1px solid #"+e.color),t.Q6J("title",null!==(a=e.description)&&void 0!==a?a:e.name)("selectable",o.selectable)("removable",o.removable),t.xp6(1),t.hij(" ",e.name," ")}}function J(n,r){if(1&n&&(t.TgZ(0,"mat-option",11),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e.name," ")}}let B=(()=>{class n extends y.z{constructor(e,o,a,i){super(e,o),this.store=e,this.snackBar=a,this.tagService=i,this.selectable=!1,this.removable=!0,this.addOnBlur=!1,this.tagInputFormControl=new p.NI,this.separatorKeysCodes=[f.K5,f.OC],this.modifyTags=new I.x,this._filteredRepoTags=[],this.modifyTags.pipe((0,O.b)(1800),(0,T.b)(l=>this.source=`tag: [${l.map(d=>d.name).join(",")}]`)).subscribe(),this.tagInputFormControl.valueChanges.pipe((0,T.b)(l=>{if(!l||"string"!=typeof l)return;const d=l.toLocaleLowerCase();this.filteredRepoTags=this.allRepoTags.filter(S=>S.name.toLocaleLowerCase().includes(d))})).subscribe()}get filteredRepoTags(){return this._filteredRepoTags}set filteredRepoTags(e){this._filteredRepoTags=e.filter(o=>!this.tagList.some(a=>a.name===o.name)),0===this._filteredRepoTags.length&&this.snackBar.open("no available tags, please add more tags","ok",{duration:c.yJ})}set tags(e){this.tagList=[],e.split(",").map(o=>o.trim()).filter(o=>""!==o).forEach(o=>this.store.tags.getById(o).then(a=>{a&&this.tagList.push(a)}))}remove(e){const o=this.tagList.findIndex(a=>a.name===e.name);o>=0&&(this.tagList.splice(o,1),this.modifyTags.next(this.tagList))}drop(e){(0,m.bA)(this.tagList,e.previousIndex,e.currentIndex),this.modifyTags.next(this.tagList)}displayFn(e){return e&&e.name?e.name:""}selected(e){const o=e.option.viewValue.trim();this.tagList.some(a=>a.name===o)?(this.filteredRepoTags=this.allRepoTags,this.autoPanel.openPanel(),this.snackBar.open(`tag ${o} already exist.`,"ok",{duration:c.yJ})):this.store.tags.getById("value").then(a=>{this.tagList.push(a),this.modifyTags.next(this.tagList)}),this.tagInput.nativeElement.value="",this.tagInputFormControl.setValue(null)}add(e){const o=(e.value||"").trim();if(o&&!this.allRepoTags.some(a=>a.name===o))return this.snackBar.open(`tag ${o} does not exist, please select from tags list`,"ok",{duration:c.yJ}),this.tagInput.nativeElement.value="",this.filteredRepoTags=this.allRepoTags,void this.autoPanel.openPanel()}tagInputFocus(){this.allRepoTags||this.tagService.getAllTags().subscribe(e=>{this.allRepoTags=e,this.filteredRepoTags=e,this.autoPanel.openPanel()})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(b.G),t.Y36(L.d),t.Y36(M.ux),t.Y36(A.u))},n.\u0275cmp=t.Xpm({type:n,selectors:[["i-tag"]],viewQuery:function(e,o){if(1&e&&(t.Gf(R,5),t.Gf(Z,5)),2&e){let a;t.iGM(a=t.CRH())&&(o.tagInput=a.first),t.iGM(a=t.CRH())&&(o.autoPanel=a.first)}},inputs:{tags:"tags"},features:[t.qOj],decls:12,vars:8,consts:[["appearance","none",1,"tags-list"],["aria-label","tags","cdkDropList","","cdkDropListOrientation","horizontal",3,"cdkDropListDropped"],["chipList",""],["class","tag","cdkDrag","",3,"color","background-color","border","title","selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","New tag...",3,"formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","focus","matChipInputTokenEnd"],["autoCompleteTrigger","matAutocompleteTrigger","tagInput",""],["autoActiveFirstOption","",3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["cdkDrag","",1,"tag",3,"title","selectable","removable","removed"],["matChipRemove","","title","delete this tag",1,"hide-button"],[3,"value"]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-form-field",0),t.TgZ(1,"mat-label"),t._uU(2,"tags"),t.qZA(),t.TgZ(3,"mat-chip-list",1,2),t.NdJ("cdkDropListDropped",function(i){return o.drop(i)}),t.YNc(5,x,5,10,"mat-chip",3),t.TgZ(6,"input",4,5),t.NdJ("focus",function(){return o.tagInputFocus()})("matChipInputTokenEnd",function(i){return o.add(i)}),t.qZA(),t.qZA(),t.TgZ(9,"mat-autocomplete",6,7),t.NdJ("optionSelected",function(i){return o.selected(i)}),t.YNc(11,J,2,2,"mat-option",8),t.qZA(),t.qZA()),2&e){const a=t.MAs(4),i=t.MAs(10);t.xp6(5),t.Q6J("ngForOf",o.tagList),t.xp6(1),t.Q6J("formControl",o.tagInputFormControl)("matAutocomplete",i)("matChipInputFor",a)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes)("matChipInputAddOnBlur",o.addOnBlur),t.xp6(3),t.Q6J("displayWith",o.displayFn),t.xp6(2),t.Q6J("ngForOf",o.filteredRepoTags)}},directives:[C.KE,C.hX,g.qn,m.Wj,h.sg,p.Fj,v.ZL,g.oH,p.JJ,p.oH,v.XC,g.HS,m.Zt,g.qH,F.Hw,P.ey],styles:[".tags-list[_ngcontent-%COMP%]{width:100%}.tags-list[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]{font-size:1.4rem;-webkit-text-stroke:.08px black}.tags-list[_ngcontent-%COMP%]   .tag.cdk-drop-list-dragging[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.tags-list[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]:hover   .hide-button[_ngcontent-%COMP%]{visibility:visible}.tags-list[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]   .hide-button[_ngcontent-%COMP%]{visibility:collapse}.tags-list[_ngcontent-%COMP%]   .cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]     .mat-form-field-wrapper{padding-bottom:.5rem}"]}),n})();var k=s(3245);let D=(()=>{class n{constructor(){this.customElementComponent=B}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[h.ez,k.B,p.UX]]}),n})()}}]);