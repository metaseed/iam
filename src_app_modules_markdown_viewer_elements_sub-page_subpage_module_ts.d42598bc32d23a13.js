"use strict";(self.webpackChunkiam=self.webpackChunkiam||[]).push([["src_app_modules_markdown_viewer_elements_sub-page_subpage_module_ts"],{1261:(L,p,n)=>{n.r(p),n.d(p,{SubPageModule:()=>Y});var g=n(6903),l=n(2265),f=n(6122),b=n(6681),v=n(3550),P=n(2518),C=n(6145),Z=n(6251),t=n(8079),m=n(1935),S=n(1180);let T=(()=>{class o{constructor(e){this.dialog=e}onClick(e){this.dialog.close(e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.so))},o.\u0275cmp=t.Xpm({type:o,selectors:[["subpage-id-search"]],decls:1,vars:0,consts:[[3,"onClick"]],template:function(e,i){1&e&&(t.TgZ(0,"doc-search-list",0),t.NdJ("onClick",function(a){return i.onClick(a)}),t.qZA())},directives:[S.I],encapsulation:2}),o})();var y=n(4060),x=n(3863),A=n(8513),O=n(7826),u=n(5682),M=n(6134),k=n(3860),I=n(7733),E=n(7394);function J(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",11),t.TgZ(1,"div",12),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().onShowDoc(a)}),t.TgZ(2,"section"),t._uU(3),t.qZA(),t.TgZ(4,"span",13),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.qZA(),t.TgZ(8,"p",14),t.TgZ(9,"button",15),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().delete(a)}),t.TgZ(10,"mat-icon"),t._uU(11,"delete_forever"),t.qZA(),t.qZA(),t.TgZ(12,"span",16),t._uU(13),t.qZA(),t.TgZ(14,"span",17),t._uU(15),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=r.$implicit;t.xp6(3),t.Oqu(e.title),t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(e.summary),t.xp6(6),t.hij(" v",e.version," "),t.xp6(2),t.AsE("",null==e.createDate?null:e.createDate.toLocaleDateString()," - ",e.updateDate.toLocaleDateString(),"")}}let N=(()=>{class o extends((0,l.P2)(C.z)){constructor(e,i,d,a,s,D,$){super(i,s),this.router=e,this.store=i,this.logger=d,this.documentEffects=a,this.dialog=D,this.snackbar=$,this.isPanelOpen=!1,this.subPagesChanged=!1,this.onPanelOpen=(()=>{let h;return()=>{if(this.isPanelOpen=!0,!this.subPagesChanged)return;this.subPagesChanged=!1,this.removeSub(h),h=this.addObs(this.store.docMetasOfIds$(this.ids).pipe((0,f.h)(c=>!!(null==c?void 0:c.length)),(0,b.U)(c=>c.filter(_=>!!_)),(0,v.b)(300),(0,P.b)(c=>this.pageList=c)));const{ids:z}=this;this.documentEffects.readDocMetas_.next({ids:z})}})(),this.ids=[],this.pageList=[]}set pages(e){this.ids=JSON.parse(e),this.subPagesChanged=!0,this.isPanelOpen&&this.onPanelOpen()}delete(e){const i=this.ids.indexOf(e.id);if(-1!==i)return this.ids.splice(i,1),this.subPagesChanged=!0,this.source=`subPage: [${this.ids}]`,void(this.isPanelOpen&&this.onPanelOpen());this.logger.debug("SubPageComponent.delete: id not found")}addId(e){this.ids.includes(+e)?this.snackbar.open(`id ${e} already included`,"ok",{duration:l.yJ}):(this.ids.push(+e),this.subPagesChanged=!0,this.source=`subPage: [${this.ids}]`)}addIdBySearch(){this.dialog.open(T,{width:"100vw",height:"90vh"}).afterClosed().subscribe(i=>this.addId(i.id))}onShowDoc(e){this.router.navigate(["/doc"],{queryParams:{id:e.id,title:e.title,f:e.format||"md"}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(y.F0),t.Y36(x.G),t.Y36(l.$V),t.Y36(Z.CL),t.Y36(A.d),t.Y36(m.uw),t.Y36(O.ux))},o.\u0275cmp=t.Xpm({type:o,selectors:[["i-subpage"]],inputs:{pages:"pages"},features:[t.qOj],decls:16,vars:2,consts:[[2,"background-color","transparent","box-shadow","none",3,"opened","closed"],[1,"action-group",3,"click"],[1,"id-input-group"],["placeholder","add by id","matInput","","type","number",1,"id-input",3,"keydown.Enter","keyup.Enter"],["input",""],["matSuffix","","mat-icon-button","","aria-label","add id",3,"click"],[2,"color","#000a"],["mat-button",""],[2,"color","#000a",3,"click"],[1,"card-container"],["class","docs-card",4,"ngFor","ngForOf"],[1,"docs-card"],[1,"card-body",3,"click"],[1,"doc-id"],[1,"meta-version-date","card-footer"],["mat-button","",1,"delete-button",3,"click"],[1,"meta-version"],[1,"meta-date",2,"margin-left","10px"]],template:function(e,i){if(1&e){const d=t.EpF();t.TgZ(0,"mat-expansion-panel",0),t.NdJ("opened",function(){return i.onPanelOpen()})("closed",function(){return i.isPanelOpen=!1}),t.TgZ(1,"mat-expansion-panel-header"),t.TgZ(2,"mat-panel-title"),t._uU(3),t.qZA(),t.TgZ(4,"div",1),t.NdJ("click",function(s){return s.stopImmediatePropagation()}),t.TgZ(5,"div",2),t.TgZ(6,"input",3,4),t.NdJ("keydown.Enter",function(s){return s.stopPropagation()})("keyup.Enter",function(){t.CHM(d);const s=t.MAs(7);return i.addId(s.value)}),t.qZA(),t.TgZ(8,"button",5),t.NdJ("click",function(){t.CHM(d);const s=t.MAs(7);return i.addId(s.value)}),t.TgZ(9,"mat-icon",6),t._uU(10,"add"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"button",7),t.TgZ(12,"mat-icon",8),t.NdJ("click",function(){return i.addIdBySearch()}),t._uU(13,"zoom_in"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",9),t.YNc(15,J,16,6,"div",10),t.qZA(),t.qZA()}2&e&&(t.xp6(3),t.hij(" Subpages(",i.ids.length,") "),t.xp6(12),t.Q6J("ngForOf",i.pageList))},directives:[u.ib,u.yz,u.yK,M.Nt,k.lW,I.R9,E.Hw,g.sg],styles:[".doc-id[_ngcontent-%COMP%]{position:absolute;right:1.2rem;font-size:small;top:1rem;color:gray}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.id-input-group[_ngcontent-%COMP%]{display:flex;border:lightgray solid .1rem;padding-left:1rem;font-size:medium;height:3rem;align-items:center}.action-group[_ngcontent-%COMP%]{display:flex;align-items:center;grid-column-gap:1rem;column-gap:1rem;margin-right:1rem}.id-input[_ngcontent-%COMP%]{width:6.5rem;margin-top:.02rem}"]}),o})();var U=n(1677),F=n(3245);let Y=(()=>{class o{constructor(){this.customElementComponent=N}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[g.ez,F.B,U.t]]}),o})()}}]);